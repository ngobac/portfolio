<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Botanical Explorer | Arabidopsis thaliana</title>

    <!-- Google Fonts - Serif, Sans-serif, and Mono -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Lato:wght@300;400;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Organic, earthy color palette */
            --sage-green: #7a9e7e;
            --sage-green-dark: #5d7a5f;
            --sage-green-light: #a4c4a6;
            --deep-brown: #4a3428;
            --terracotta: #c97154;
            --terracotta-light: #e09176;
            --parchment: #f4f1ea;
            --parchment-dark: #e8e3d6;
            --charcoal: #2d2d2d;
            --moss-green: #8b9d83;
            --sepia: #704214;

            /* Typography */
            --font-serif: 'EB Garamond', serif;
            --font-sans: 'Lato', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, var(--parchment) 0%, var(--parchment-dark) 100%);
            color: var(--charcoal);
            min-height: 100vh;
            background-attachment: fixed;
        }

        /* Header with navigation */
        .header {
            background: linear-gradient(to bottom, rgba(122, 158, 126, 0.95), rgba(122, 158, 126, 0.85));
            backdrop-filter: blur(10px);
            border-bottom: 3px solid var(--deep-brown);
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-family: var(--font-serif);
            font-size: 2.5rem;
            color: var(--parchment);
            font-weight: 600;
            letter-spacing: 0.02em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-family: var(--font-serif);
            font-size: 1rem;
            color: var(--parchment-dark);
            font-style: italic;
            margin-top: 0.25rem;
        }

        .nav-link {
            color: var(--parchment);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            border-color: var(--parchment);
            background: rgba(244, 241, 234, 0.1);
        }

        /* Main container */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 2rem;
            align-items: start;
        }

        /* SVG Container */
        .svg-container {
            background: white;
            border: 4px solid var(--deep-brown);
            border-radius: 8px;
            padding: 3rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            position: relative;
            min-height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .svg-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(122, 158, 126, 0.03) 2px,
                    rgba(122, 158, 126, 0.03) 4px
                );
            pointer-events: none;
            border-radius: 4px;
        }

        #plant-diagram {
            max-width: 100%;
            height: auto;
            filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.1));
            position: relative;
            z-index: 1;
        }

        /* Info Panel */
        .info-panel {
            background: white;
            border: 4px solid var(--sage-green-dark);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .tab-header {
            display: flex;
            background: var(--sage-green);
            border-bottom: 3px solid var(--deep-brown);
        }

        .tab-button {
            flex: 1;
            padding: 1rem;
            background: transparent;
            border: none;
            color: var(--parchment);
            font-family: var(--font-serif);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }

        .tab-button:last-child {
            border-right: none;
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .tab-button.active {
            background: white;
            color: var(--sage-green-dark);
            font-weight: 600;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--terracotta);
        }

        .tab-content {
            display: none;
            padding: 2rem;
            max-height: 600px;
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content h2 {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            color: var(--sage-green-dark);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--terracotta);
            padding-bottom: 0.5rem;
        }

        .tab-content h3 {
            font-family: var(--font-serif);
            font-size: 1.3rem;
            color: var(--deep-brown);
            margin: 1.5rem 0 0.75rem;
        }

        .tab-content p {
            line-height: 1.8;
            margin-bottom: 1rem;
            color: var(--charcoal);
        }

        .taxonomy-item {
            display: grid;
            grid-template-columns: 140px 1fr;
            gap: 1rem;
            margin-bottom: 0.75rem;
            padding: 0.5rem;
            background: var(--parchment);
            border-left: 3px solid var(--sage-green);
            border-radius: 4px;
        }

        .taxonomy-label {
            font-family: var(--font-serif);
            font-weight: 600;
            color: var(--deep-brown);
        }

        .taxonomy-value {
            font-family: var(--font-mono);
            color: var(--charcoal);
            font-size: 0.95rem;
        }

        .morphology-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--parchment);
            border-radius: 6px;
            border: 1px solid var(--sage-green-light);
        }

        .growth-stage {
            background: white;
            border: 2px solid var(--sage-green);
            border-radius: 6px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .growth-stage:hover {
            transform: translateX(5px);
            box-shadow: -4px 4px 0 var(--terracotta-light);
        }

        .stage-number {
            font-family: var(--font-serif);
            font-size: 2rem;
            color: var(--terracotta);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stage-name {
            font-family: var(--font-serif);
            font-size: 1.2rem;
            color: var(--sage-green-dark);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .stage-duration {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--sepia);
            margin-bottom: 0.75rem;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        ul li::before {
            content: '→';
            position: absolute;
            left: 0;
            color: var(--terracotta);
            font-weight: bold;
        }

        /* Highlighted elements */
        .po-element {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .po-element:hover {
            filter: brightness(1.2);
        }

        .po-element.highlighted {
            filter: brightness(1.3) drop-shadow(0 0 8px var(--terracotta));
        }

        /* Legend */
        .legend {
            background: white;
            border: 3px solid var(--deep-brown);
            border-radius: 6px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .legend h3 {
            font-family: var(--font-serif);
            color: var(--deep-brown);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            gap: 0.75rem;
        }

        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: 2px solid var(--deep-brown);
        }

        .legend-label {
            font-family: var(--font-sans);
            color: var(--charcoal);
        }

        .legend-po {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--sepia);
            margin-left: auto;
        }

        /* Scrollbar styling */
        .tab-content::-webkit-scrollbar {
            width: 8px;
        }

        .tab-content::-webkit-scrollbar-track {
            background: var(--parchment);
        }

        .tab-content::-webkit-scrollbar-thumb {
            background: var(--sage-green);
            border-radius: 4px;
        }

        .tab-content::-webkit-scrollbar-thumb:hover {
            background: var(--sage-green-dark);
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .container {
                padding: 0 1rem;
                margin: 1rem auto;
            }

            .svg-container {
                padding: 2rem;
            }

            .tab-content {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <div>
                <h1>Interactive Botanical Explorer</h1>
                <p class="subtitle" id="plant-subtitle">Select a plant species</p>
            </div>
            <a href="index.html" class="nav-link">← Back to Portfolio</a>
        </div>
    </header>

    <!-- Plant Selector -->
    <div style="max-width: 1400px; margin: 1.5rem auto; padding: 0 2rem;">
        <div style="background: white; border: 3px solid var(--sage-green-dark); border-radius: 8px; padding: 1.5rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
            <label for="plant-select" style="font-family: var(--font-serif); font-size: 1.2rem; color: var(--deep-brown); margin-right: 1rem; font-weight: 600;">Choose Plant Species:</label>
            <select id="plant-select" style="font-family: var(--font-sans); font-size: 1rem; padding: 0.75rem 1.5rem; border: 2px solid var(--sage-green); border-radius: 6px; background: var(--parchment); color: var(--charcoal); cursor: pointer; min-width: 300px;">
                <option value="rose">Rosa (Rose / Hoa Hồng)</option>
                <option value="mangrove">Rhizophora apiculata (Mangrove / Đước Đôi)</option>
                <option value="rubber">Hevea brasiliensis (Rubber Tree / Cây Cao Su)</option>
            </select>
        </div>
    </div>

    <div class="container">
        <div>
            <div class="svg-container">
                <div id="plant-diagram"></div>
            </div>

            <div class="legend" id="plant-legend">
                <h3>Plant Structures</h3>
                <div id="legend-content">
                    <!-- Legend will be populated dynamically -->
                </div>
            </div>
        </div>

        <div class="info-panel">
            <div class="tab-header">
                <button class="tab-button active" data-tab="taxonomy">Taxonomy</button>
                <button class="tab-button" data-tab="morphology">Morphology</button>
                <button class="tab-button" data-tab="growth">Growth Stages</button>
            </div>

            <div class="tab-content active" id="taxonomy">
                <!-- Content will be populated dynamically -->
            </div>

            <div class="tab-content" id="morphology">
                <!-- Content will be populated dynamically -->
            </div>

            <div class="tab-content" id="growth">
                <!-- Content will be populated dynamically -->
            </div>
        </div>
    </div>

    <script>
        // Plant database
        const plantData = {
            rose: {
                scientificName: 'Rosa',
                commonName: 'Rose / Hoa Hồng',
                svgFile: 'rose_diagram.svg',
                subtitle: 'Rosa • Rose / Hoa Hồng',
                legend: [
                    { color: '#e74c3c', label: 'Flower (Petals)', code: 'Rose Flower' },
                    { color: '#27ae60', label: 'Compound Leaves', code: 'Pinnate Leaves' },
                    { color: '#2ecc71', label: 'Stem', code: 'With Thorns' },
                    { color: '#8b7355', label: 'Root System', code: 'Taproot' }
                ],
                taxonomy: [
                    { label: 'Kingdom', value: 'Plantae' },
                    { label: 'Clade', value: 'Angiosperms' },
                    { label: 'Clade', value: 'Eudicots' },
                    { label: 'Clade', value: 'Rosids' },
                    { label: 'Order', value: 'Rosales' },
                    { label: 'Family', value: 'Rosaceae' },
                    { label: 'Subfamily', value: 'Rosoideae' },
                    { label: 'Genus', value: 'Rosa' }
                ],
                significance: `Roses are among the most beloved and cultivated flowering plants worldwide. With over 300 species and thousands of cultivars, roses have been symbols of love, beauty, and passion across cultures for millennia. They are valued not only for their spectacular flowers but also for their fragrance, which is used in perfumery and aromatherapy.`,
                distribution: `Wild roses are native to temperate regions of the Northern Hemisphere, including Asia, Europe, North America, and Northwest Africa. Cultivated roses are now grown worldwide in gardens, parks, and commercial nurseries. Different species have adapted to various climates, from cold-hardy rugosa roses to heat-tolerant tea roses.`,
                morphology: [
                    {
                        title: 'Flowers',
                        description: 'Rose flowers exhibit remarkable diversity in form, size, and color. The classic rose flower consists of multiple layers of petals arranged in a spiral pattern.',
                        features: [
                            '<strong>Petals:</strong> Typically 5 petals in wild species; cultivated varieties can have dozens of petals in layered arrangements',
                            '<strong>Colors:</strong> Range from white, yellow, pink, red, to purple and even multicolored varieties',
                            '<strong>Fragrance:</strong> Many roses produce essential oils with distinctive sweet scents',
                            '<strong>Size:</strong> Varies from miniature roses (< 2 cm) to hybrid tea roses (> 10 cm diameter)'
                        ]
                    },
                    {
                        title: 'Leaves',
                        description: 'Roses have compound pinnate leaves, typically with 5-9 leaflets (odd number) arranged along a central rachis.',
                        features: [
                            '<strong>Leaflet Shape:</strong> Ovate to elliptical with serrated (toothed) margins',
                            '<strong>Surface:</strong> Usually dark green, glossy or matte depending on variety',
                            '<strong>Stipules:</strong> Present at the base of the petiole, often fused to the stem',
                            '<strong>Arrangement:</strong> Alternate along the stem'
                        ]
                    },
                    {
                        title: 'Stems & Thorns',
                        description: 'Rose stems are characteristically armed with prickles (commonly called thorns), though some varieties are thornless.',
                        features: [
                            '<strong>Prickles:</strong> Sharp, curved outgrowths that protect from herbivores',
                            '<strong>Stem Structure:</strong> Woody, can be erect, climbing, or trailing',
                            '<strong>Color:</strong> Green when young, turning brown and woody with age',
                            '<strong>Height:</strong> Varies from miniature (30 cm) to climbing varieties (> 6 meters)'
                        ]
                    },
                    {
                        title: 'Root System',
                        description: 'Roses develop a fibrous to taproot system, with many varieties being grafted onto rootstocks.',
                        features: [
                            '<strong>Structure:</strong> Deep taproot with extensive lateral roots',
                            '<strong>Depth:</strong> Can reach 1-2 meters in mature plants',
                            '<strong>Grafting:</strong> Most cultivated roses are grafted onto hardy rootstock',
                            '<strong>Function:</strong> Efficient water and nutrient uptake'
                        ]
                    }
                ],
                growth: [
                    {
                        number: '1',
                        name: 'Planting & Establishment',
                        duration: 'Weeks 1-4',
                        description: 'Roses can be propagated from seeds, cuttings, or grafted plants. Most commercial roses are grafted.',
                        stages: [
                            'Bare-root or containerized plants are planted in well-draining soil',
                            'Root system establishes and begins to spread',
                            'First shoots emerge from buds on the canes',
                            'Regular watering is critical during establishment'
                        ]
                    },
                    {
                        number: '2',
                        name: 'Vegetative Growth',
                        duration: 'Spring - Summer (3-4 months)',
                        description: 'Active growth phase with rapid production of new canes, leaves, and stems.',
                        stages: [
                            'New canes grow from the base (basal breaks)',
                            'Leaves develop along the canes in alternating pattern',
                            'Plant focuses on building strong structure',
                            'Photosynthesis drives carbohydrate production and storage'
                        ]
                    },
                    {
                        number: '3',
                        name: 'Flowering',
                        duration: 'Late Spring - Fall (varies by climate)',
                        description: 'Flower buds form at the tips of new growth and develop into blooms.',
                        stages: [
                            'Flower buds (rose hips precursors) form at stem terminals',
                            'Buds swell and sepals begin to open',
                            'Petals unfurl in spiral pattern, revealing stamens and pistils',
                            'Peak bloom lasts 3-7 days depending on temperature and variety',
                            'Repeat-flowering varieties produce multiple flushes per season'
                        ]
                    },
                    {
                        number: '4',
                        name: 'Pollination & Hip Formation',
                        duration: 'After flowering',
                        description: 'Following pollination, rose hips (fruit) develop containing seeds.',
                        stages: [
                            'Insects (bees, butterflies) or wind pollinate flowers',
                            'Petals drop after pollination',
                            'Ovary swells and develops into rose hip',
                            'Hips ripen, turning red, orange, or black',
                            'Each hip contains multiple seeds (achenes)'
                        ]
                    },
                    {
                        number: '5',
                        name: 'Dormancy',
                        duration: 'Winter (in temperate climates)',
                        description: 'Roses enter dormancy in response to cold temperatures and shorter days.',
                        stages: [
                            'Growth slows as temperatures drop and daylight decreases',
                            'Leaves may drop in deciduous varieties',
                            'Plant stores carbohydrates in roots and canes',
                            'Canes harden off for winter protection',
                            'Minimal metabolic activity until spring'
                        ]
                    }
                ],
                environment: [
                    { factor: 'Sunlight', requirement: 'Full sun (6-8 hours daily) for best flowering' },
                    { factor: 'Soil', requirement: 'Well-draining, slightly acidic to neutral (pH 6.0-7.0), rich in organic matter' },
                    { factor: 'Water', requirement: 'Consistent moisture, 1-2 inches per week; avoid overhead watering to prevent disease' },
                    { factor: 'Temperature', requirement: 'Most varieties hardy in zones 5-9; some tolerate extremes' },
                    { factor: 'Fertilization', requirement: 'Regular feeding during growing season with balanced or rose-specific fertilizer' }
                ]
            },
            mangrove: {
                scientificName: 'Rhizophora apiculata',
                commonName: 'Mangrove / Đước Đôi',
                svgFile: 'mangrove_diagram.svg',
                subtitle: 'Rhizophora apiculata • Mangrove / Đước Đôi',
                legend: [
                    { color: '#228b22', label: 'Leathery Leaves', code: 'Salt-tolerant' },
                    { color: '#654321', label: 'Trunk', code: 'Mangrove Wood' },
                    { color: '#8b6f47', label: 'Prop/Stilt Roots', code: 'Aerial Support' },
                    { color: '#5d4e37', label: 'Underground Roots', code: 'Anchor System' }
                ],
                taxonomy: [
                    { label: 'Kingdom', value: 'Plantae' },
                    { label: 'Clade', value: 'Angiosperms' },
                    { label: 'Clade', value: 'Eudicots' },
                    { label: 'Clade', value: 'Rosids' },
                    { label: 'Order', value: 'Malpighiales' },
                    { label: 'Family', value: 'Rhizophoraceae' },
                    { label: 'Genus', value: 'Rhizophora' },
                    { label: 'Species', value: 'R. apiculata' }
                ],
                significance: `Rhizophora apiculata is a true mangrove species found in coastal intertidal zones of the Indo-Pacific region. It plays a crucial ecological role in coastal protection, providing habitat for marine life, filtering water, sequestering carbon, and stabilizing shorelines against erosion and storm surges. Mangrove forests are among the most productive ecosystems on Earth.`,
                distribution: `Native to tropical and subtropical coastlines of the Indo-Pacific region, from East Africa through South and Southeast Asia to Australia and the Pacific Islands. Thrives in saline, waterlogged soils of estuaries, lagoons, and tidal mudflats. Found in Vietnam's Mekong Delta, Malaysian coastlines, and throughout Indonesia.`,
                morphology: [
                    {
                        title: 'Prop/Stilt Roots',
                        description: 'The most distinctive feature of Rhizophora species is their extensive system of arching prop roots that provide stability in soft, muddy substrates.',
                        features: [
                            '<strong>Structure:</strong> Adventitious roots emerging from the trunk and branches, arching downward into the mud',
                            '<strong>Function:</strong> Provide structural support in unstable sediments, resist wave action and tidal forces',
                            '<strong>Gas Exchange:</strong> Contain lenticels (pores) for oxygen uptake in anaerobic soils',
                            '<strong>Development:</strong> New prop roots continuously form as the tree grows, creating a dense root network'
                        ]
                    },
                    {
                        title: 'Leaves',
                        description: 'Mangrove leaves are specially adapted to cope with high salinity and water stress.',
                        features: [
                            '<strong>Morphology:</strong> Elliptical, leathery, and thick with entire margins',
                            '<strong>Size:</strong> 7-15 cm long, 3-6 cm wide',
                            '<strong>Adaptations:</strong> Thick cuticle reduces water loss; salt-excreting glands on leaf surface',
                            '<strong>Arrangement:</strong> Opposite arrangement on branches',
                            '<strong>Color:</strong> Dark green, glossy upper surface'
                        ]
                    },
                    {
                        title: 'Viviparous Seedlings (Propagules)',
                        description: 'Rhizophora exhibits vivipary—seeds germinate while still attached to the parent tree, developing into torpedo-shaped propagules.',
                        features: [
                            '<strong>Development:</strong> Embryo grows within the fruit still on the tree',
                            '<strong>Size:</strong> Propagules can reach 20-40 cm in length',
                            '<strong>Dispersal:</strong> Propagules drop into water and float until finding suitable substrate',
                            '<strong>Establishment:</strong> Pointed tip anchors in mud, and roots develop rapidly',
                            '<strong>Survival:</strong> Propagules can survive floating for weeks to months, enabling long-distance dispersal'
                        ]
                    },
                    {
                        title: 'Pneumatophores & Root System',
                        description: 'In addition to prop roots, mangroves have specialized breathing roots and underground networks.',
                        features: [
                            '<strong>Pneumatophores:</strong> Small vertical projections from horizontal roots that protrude above water for gas exchange',
                            '<strong>Cable Roots:</strong> Horizontal roots spreading through substrate',
                            '<strong>Anchor Roots:</strong> Deep penetrating roots for stability',
                            '<strong>Lenticels:</strong> Pores on root surfaces allowing oxygen diffusion to submerged tissues'
                        ]
                    }
                ],
                growth: [
                    {
                        number: '1',
                        name: 'Propagule Development',
                        duration: '6-12 months',
                        description: 'Unique viviparous reproduction where seedlings develop while attached to parent tree.',
                        stages: [
                            'Flowers are pollinated (wind or insect)',
                            'Embryo develops within fruit still on the tree',
                            'Hypocotyl elongates, forming a cigar-shaped propagule',
                            'Propagule grows to 20-40 cm, developing chlorophyll',
                            'Mature propagule detaches and drops into water or mud'
                        ]
                    },
                    {
                        number: '2',
                        name: 'Dispersal & Establishment',
                        duration: 'Days to months',
                        description: 'Propagules float and disperse via tides and currents until finding suitable substrate.',
                        stages: [
                            'Propagule floats horizontally in water, buoyant for weeks',
                            'Gradually becomes waterlogged and shifts to vertical orientation',
                            'Pointed tip embeds in muddy substrate during low tide',
                            'Root primordial cells activate and roots emerge within 24-48 hours',
                            'Rapid root growth anchors the seedling'
                        ]
                    },
                    {
                        number: '3',
                        name: 'Seedling Growth',
                        duration: '1-3 years',
                        description: 'Young mangrove develops first true leaves and begins forming prop roots.',
                        stages: [
                            'Cotyledons (seed leaves) emerge and photosynthesize',
                            'First true leaves develop in opposite pairs',
                            'Primary root system establishes in substrate',
                            'First adventitious prop roots begin forming from lower stem',
                            'Height increases to 0.5-2 meters'
                        ]
                    },
                    {
                        number: '4',
                        name: 'Juvenile Tree Development',
                        duration: '3-10 years',
                        description: 'Rapid vertical and lateral growth with extensive prop root formation.',
                        stages: [
                            'Trunk diameter and height increase significantly',
                            'Multiple tiers of prop roots form, creating stable architecture',
                            'Canopy expands with branching pattern',
                            'Tree reaches 3-8 meters in height',
                            'Salt-exclusion mechanisms fully functional in roots'
                        ]
                    },
                    {
                        number: '5',
                        name: 'Mature Reproductive Tree',
                        duration: '10+ years to 100+ years',
                        description: 'Mature mangroves begin flowering and producing propagules, contributing to forest regeneration.',
                        stages: [
                            'First flowering typically occurs at 5-7 years of age',
                            'Tree reaches mature height of 10-25 meters (can exceed 30m in optimal conditions)',
                            'Produces flowers and propagules annually or biannually',
                            'Extensive root system stabilizes large area of sediment',
                            'Tree can live 100+ years, continuously growing and reproducing'
                        ]
                    }
                ],
                environment: [
                    { factor: 'Salinity', requirement: 'Highly salt-tolerant; thrives in brackish to full seawater (up to 35 ppt)' },
                    { factor: 'Water', requirement: 'Intertidal zone; submerged during high tide, exposed during low tide' },
                    { factor: 'Substrate', requirement: 'Soft, muddy, anaerobic sediments rich in organic matter' },
                    { factor: 'Temperature', requirement: 'Tropical to subtropical; 20-35°C optimal; frost-sensitive' },
                    { factor: 'Tidal Range', requirement: 'Requires regular tidal inundation; adapted to daily flood/exposure cycles' }
                ]
            },
            rubber: {
                scientificName: 'Hevea brasiliensis',
                commonName: 'Rubber Tree / Cây Cao Su',
                svgFile: 'rubber_tree_diagram.svg',
                subtitle: 'Hevea brasiliensis • Rubber Tree / Cây Cao Su',
                legend: [
                    { color: '#2ecc71', label: 'Palmate Compound Leaves', code: '3-5 Leaflets' },
                    { color: '#8b7355', label: 'Trunk with Latex', code: 'Source of Natural Rubber' },
                    { color: '#6b5939', label: 'Root System', code: 'Deep Taproot' },
                    { color: '#f8f9f9', label: 'Latex (Sap)', code: 'Commercial Rubber Source' }
                ],
                taxonomy: [
                    { label: 'Kingdom', value: 'Plantae' },
                    { label: 'Clade', value: 'Angiosperms' },
                    { label: 'Clade', value: 'Eudicots' },
                    { label: 'Clade', value: 'Rosids' },
                    { label: 'Order', value: 'Malpighiales' },
                    { label: 'Family', value: 'Euphorbiaceae' },
                    { label: 'Genus', value: 'Hevea' },
                    { label: 'Species', value: 'H. brasiliensis' }
                ],
                significance: `Hevea brasiliensis is the primary commercial source of natural rubber (latex), one of the most important industrial raw materials. Natural rubber is essential for manufacturing tires, medical gloves, adhesives, and thousands of other products. The rubber industry supports millions of livelihoods, particularly in Southeast Asia, which produces over 90% of the world's natural rubber.`,
                distribution: `Native to the Amazon rainforest of Brazil, Bolivia, Peru, Colombia, Venezuela, and the Guianas. Introduced to Southeast Asia in the 1870s, where it now thrives in large plantations across Thailand, Indonesia, Vietnam, Malaysia, and India. Requires tropical climate with high rainfall and warm temperatures year-round.`,
                morphology: [
                    {
                        title: 'Latex System',
                        description: 'The latex system is the defining feature of rubber trees, consisting of specialized cells (laticifers) that produce and store milky latex sap.',
                        features: [
                            '<strong>Laticifers:</strong> Specialized tubelike cells arranged in concentric rings in the bark',
                            '<strong>Latex Composition:</strong> 30-40% rubber polymer (polyisoprene), 55-65% water, plus proteins, sugars, and minerals',
                            '<strong>Tapping:</strong> Bark is cut in a herringbone pattern to allow latex to flow out',
                            '<strong>Regeneration:</strong> Latex-producing cells regenerate, allowing repeated tapping for 25-30 years',
                            '<strong>Yield:</strong> Mature tree produces 2-3 kg of dry rubber per year'
                        ]
                    },
                    {
                        title: 'Leaves',
                        description: 'Rubber tree leaves are trifoliate (3-leaflet) compound leaves arranged alternately on branches.',
                        features: [
                            '<strong>Structure:</strong> Three elliptical leaflets on a common petiole',
                            '<strong>Size:</strong> Each leaflet 8-20 cm long, 3-10 cm wide',
                            '<strong>Texture:</strong> Smooth, glossy, dark green upper surface; paler beneath',
                            '<strong>New Growth:</strong> Young leaves are reddish-bronze before turning green',
                            '<strong>Arrangement:</strong> Spiral (alternate) phyllotaxis on branches'
                        ]
                    },
                    {
                        title: 'Trunk & Bark',
                        description: 'The trunk contains the valuable latex system and can grow quite large in mature plantations.',
                        features: [
                            '<strong>Height:</strong> 20-30 meters in mature trees',
                            '<strong>Diameter:</strong> 30-60 cm at breast height in tappable trees',
                            '<strong>Bark:</strong> Smooth when young, becoming rougher and fissured with age',
                            '<strong>Tapping Panel:</strong> Section of bark regularly renewed for latex extraction',
                            '<strong>Color:</strong> Grayish-brown outer bark; inner bark releases white latex when cut'
                        ]
                    },
                    {
                        title: 'Root System & Fruit',
                        description: 'Deep root system and trilocular capsule fruits containing large seeds.',
                        features: [
                            '<strong>Roots:</strong> Deep taproot extending 2-3 meters, extensive lateral roots',
                            '<strong>Fruit:</strong> Trilocular capsule, 3-5 cm diameter, explosively dehiscent',
                            '<strong>Seeds:</strong> Large (2-3 cm), mottled brown, oval-shaped, 3 per fruit',
                            '<strong>Dispersal:</strong> Capsules explode when ripe, propelling seeds several meters',
                            '<strong>Oil Content:</strong> Seeds contain 40-50% oil (used for biodiesel and other products)'
                        ]
                    }
                ],
                growth: [
                    {
                        number: '1',
                        name: 'Seed Germination & Seedling',
                        duration: '1-2 weeks (germination); 1-2 years (nursery)',
                        description: 'Rubber trees are typically grown from seeds in nurseries before field planting.',
                        stages: [
                            'Fresh seeds germinate within 7-14 days (seeds lose viability quickly)',
                            'Radicle emerges first, followed by hypocotyl',
                            'Cotyledons emerge and first true leaves develop',
                            'Seedlings grow in nursery for 12-18 months',
                            'Budding/grafting is performed to ensure high-yielding clones'
                        ]
                    },
                    {
                        number: '2',
                        name: 'Immature Phase',
                        duration: 'Years 1-5 (after field planting)',
                        description: 'Young trees establish in plantation and focus on vegetative growth.',
                        stages: [
                            'Grafted plants are transplanted to plantation at 1-2 years old',
                            'Rapid vegetative growth: 1-2 meters of height gain per year',
                            'Root system establishes deeply in soil',
                            'Canopy develops with characteristic trifoliate leaves',
                            'Trees reach 4-6 meters by year 5',
                            'Latex system is developing but not yet tappable'
                        ]
                    },
                    {
                        number: '3',
                        name: 'Immature to Tappable',
                        duration: 'Years 5-7',
                        description: 'Trees reach the size and maturity required for latex tapping to begin.',
                        stages: [
                            'Trunk circumference reaches 45-50 cm at 1 meter height',
                            'Bark thickness adequate for tapping (6-8 mm)',
                            'Latex system fully developed with mature laticifers',
                            'Trees reach 8-12 meters in height',
                            'First tapping typically begins in year 6-7'
                        ]
                    },
                    {
                        number: '4',
                        name: 'Productive Tapping Period',
                        duration: 'Years 7-32 (approximately 25 years of tapping)',
                        description: 'Mature trees are regularly tapped for latex production.',
                        stages: [
                            'Tapping begins: bark cut in downward spiral at 30° angle',
                            'Latex flows for 2-3 hours per tapping session',
                            'Tapping frequency: every 2-4 days, depending on clone and conditions',
                            'Annual yield increases for first 10-15 years of tapping',
                            'Peak production at 15-20 years of age: 2-3 kg dry rubber/tree/year',
                            'Trees continue growing taller (20-30 meters) during productive phase'
                        ]
                    },
                    {
                        number: '5',
                        name: 'Senescence & Replanting',
                        duration: 'Year 30-35+',
                        description: 'Trees become economically unproductive and are replaced with new planting.',
                        stages: [
                            'Latex production declines as bark regeneration slows',
                            'Tapping becomes increasingly difficult',
                            'Trees are felled and removed from plantation',
                            'Wood is used for furniture, construction, or fuel',
                            'New seedlings/grafts are planted to restart the cycle',
                            'Some trees left unharvested can live 100+ years'
                        ]
                    }
                ],
                environment: [
                    { factor: 'Climate', requirement: 'Tropical; 24-28°C year-round; cannot tolerate frost' },
                    { factor: 'Rainfall', requirement: '2000-4000 mm annually, well-distributed (no long dry season)' },
                    { factor: 'Soil', requirement: 'Deep, well-drained, slightly acidic (pH 5-6); loamy or clay loam preferred' },
                    { factor: 'Elevation', requirement: 'Sea level to 600 meters; optimal below 300 meters' },
                    { factor: 'Humidity', requirement: 'High atmospheric humidity (>80%) for best latex production' }
                ]
            }
        };

        // Sound feedback system using Web Audio API
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playOrganicSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            // Organic, natural sound parameters
            switch(type) {
                case 'rustle':
                    // Soft rustling sound
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(120, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(80, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.03, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    break;
                case 'snap':
                    // Crisp snapping sound
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.05);
                    gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
                    break;
                case 'hover':
                    // Gentle hover sound
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.02, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.08);
                    break;
            }

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.15);
        }

        // Populate plant content
        function populatePlantContent(plantKey) {
            const plant = plantData[plantKey];

            // Update subtitle
            document.getElementById('plant-subtitle').textContent = plant.subtitle;

            // Update legend
            const legendContent = document.getElementById('legend-content');
            legendContent.innerHTML = plant.legend.map(item => `
                <div class="legend-item">
                    <div class="legend-color" style="background: ${item.color};"></div>
                    <span class="legend-label">${item.label}</span>
                    <span class="legend-po">${item.code}</span>
                </div>
            `).join('');

            // Update taxonomy tab
            const taxonomyTab = document.getElementById('taxonomy');
            taxonomyTab.innerHTML = `
                <h2>Taxonomic Classification</h2>
                ${plant.taxonomy.map(item => `
                    <div class="taxonomy-item">
                        <div class="taxonomy-label">${item.label}:</div>
                        <div class="taxonomy-value">${item.value}</div>
                    </div>
                `).join('')}

                <h3>Scientific Significance</h3>
                <p>${plant.significance}</p>

                <h3>Distribution</h3>
                <p>${plant.distribution}</p>
            `;

            // Update morphology tab
            const morphologyTab = document.getElementById('morphology');
            morphologyTab.innerHTML = `
                <h2>Morphological Features</h2>
                ${plant.morphology.map(section => `
                    <div class="morphology-section">
                        <h3>${section.title}</h3>
                        <p>${section.description}</p>
                        <ul>
                            ${section.features.map(feature => `<li>${feature}</li>`).join('')}
                        </ul>
                    </div>
                `).join('')}
            `;

            // Update growth tab
            const growthTab = document.getElementById('growth');
            growthTab.innerHTML = `
                <h2>Life Cycle & Development</h2>
                ${plant.growth.map(stage => `
                    <div class="growth-stage">
                        <div class="stage-number">${stage.number}</div>
                        <div class="stage-name">${stage.name}</div>
                        <div class="stage-duration">${stage.duration}</div>
                        <p>${stage.description}</p>
                        <ul>
                            ${stage.stages.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                    </div>
                `).join('')}

                ${plant.environment ? `
                    <h3>Environmental Requirements</h3>
                    <ul>
                        ${plant.environment.map(env => `
                            <li><strong>${env.factor}:</strong> ${env.requirement}</li>
                        `).join('')}
                    </ul>
                ` : ''}
            `;
        }

        // Load and fix SVG
        async function loadPlantSVG(plantKey = 'rose') {
            const plant = plantData[plantKey];
            const svgUrl = plant.svgFile;

            try {
                const response = await fetch(svgUrl);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const svgText = await response.text();

                // Parse SVG
                const parser = new DOMParser();
                const svgDoc = parser.parseFromString(svgText, 'image/svg+xml');
                const svgElement = svgDoc.querySelector('svg');

                // Critical: Remove visibility:hidden and apply default fills/strokes
                svgElement.style.visibility = 'visible';
                svgElement.style.display = 'block';

                // Set proper dimensions for display
                svgElement.setAttribute('width', '400');
                svgElement.setAttribute('height', 'auto');

                // Apply default styling to all paths and elements
                const allElements = svgElement.querySelectorAll('*');
                allElements.forEach(element => {
                    // Remove default invisible styling
                    if (element.style.fill === 'none') {
                        element.style.fill = '';
                    }
                    if (element.style.stroke === 'none') {
                        element.style.stroke = '';
                    }

                    // Apply organic colors based on PO IDs
                    const poId = element.id || element.getAttribute('id');

                    if (poId) {
                        element.classList.add('po-element');

                        // Color coding based on plant parts
                        if (poId.includes('PO_0025034') || poId.toLowerCase().includes('leaf')) {
                            // Leaves - sage green
                            element.style.fill = '#8fbc8f';
                            element.style.stroke = '#5d7a5f';
                            element.style.strokeWidth = '1.5';
                        } else if (poId.includes('PO_0009005') || poId.toLowerCase().includes('root')) {
                            // Roots - earth brown
                            element.style.fill = '#8b7355';
                            element.style.stroke = '#6b5939';
                            element.style.strokeWidth = '1.5';
                        } else if (poId.includes('PO_0009046') || poId.toLowerCase().includes('flower')) {
                            // Flowers - soft yellow
                            element.style.fill = '#f4d03f';
                            element.style.stroke = '#d4a404';
                            element.style.strokeWidth = '1.5';
                        }

                        // Add interactivity
                        element.addEventListener('mouseenter', () => {
                            element.classList.add('highlighted');
                            playOrganicSound('hover');
                        });

                        element.addEventListener('mouseleave', () => {
                            element.classList.remove('highlighted');
                        });

                        element.addEventListener('click', () => {
                            playOrganicSound('snap');
                            console.log('Plant Ontology ID:', poId);
                        });
                    }
                });

                // Also apply default colors to elements without IDs
                svgElement.querySelectorAll('path, circle, rect, polygon').forEach(element => {
                    if (!element.id && !element.hasAttribute('id')) {
                        // Default plant green
                        if (!element.style.fill || element.style.fill === 'none') {
                            element.style.fill = '#7a9e7e';
                        }
                        if (!element.style.stroke || element.style.stroke === 'none') {
                            element.style.stroke = '#5d7a5f';
                            element.style.strokeWidth = '1';
                        }
                    }
                });

                // Insert into container
                const container = document.getElementById('plant-diagram');
                container.innerHTML = '';
                container.appendChild(svgElement);

                console.log('SVG loaded successfully with', allElements.length, 'elements');

            } catch (error) {
                console.error('Error loading SVG:', error);
                document.getElementById('plant-diagram').innerHTML =
                    '<p style="color: var(--terracotta); text-align: center;">Error loading botanical diagram. Please check your connection.</p>';
            }
        }

        // Tab switching functionality
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                playOrganicSound('rustle');

                // Remove active class from all
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));

                // Add active class to clicked tab
                button.classList.add('active');
                const tabId = button.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Plant selector change handler
        document.getElementById('plant-select').addEventListener('change', function() {
            const plantKey = this.value;
            playOrganicSound('snap');
            loadPlantSVG(plantKey);
            populatePlantContent(plantKey);
        });

        // Load default plant (rose) on page load
        window.addEventListener('DOMContentLoaded', () => {
            const defaultPlant = 'rose';
            populatePlantContent(defaultPlant);
            loadPlantSVG(defaultPlant);
        });
    </script>
</body>
</html>
